#readers = new Array()
#c = null
$ ->
	showCards = (name, rdr_id) ->
		canvas = $('#canvas_for_library_card').get(0)
		context = canvas.getContext('2d')
		context.font = '17px Times New Roman'	  
		readers1 = new Image()
		readers2 = new Image()
		readers1.src = "<%= asset_path('library/reader1.gif') %>"
		readers2.src = "<%= asset_path('library/reader2.gif') %>"
		fio = name.split(' ')
		readers1.onload = ->
			canvas.width = readers1.width * 2.5
			canvas.height = readers1.height + 10
			context.drawImage(readers1, 2, 2)
			context.fillText(fio[0], 210, 90)
			context.fillText(fio[1], 210, 105)
			context.fillText(fio[2], 210, 122)
		readers2.onload = ->
		  context.drawImage(readers2, 370, 2)
    barcodes = new Image()
    barcodes.src = "<%= asset_path('library/barcode.png') %>"
    barcodes.onload = ->
      if barcodes.width < 97
        context.drawImage(barcodes, 147, 140, barcodes.width, barcodes.height/1.2)
      else
        context.drawImage(barcodes, 147, 140, barcodes.width/1.6, barcodes.height/1.2)
      context.fillText(rdr_id, 215, 210)


	if $('#canvas_for_library_card').length > 0
    	showCards($('#library_reader').data('name'), $('#library_reader').data('value'))

